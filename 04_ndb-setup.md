# NDB Server のセットアップ

NDB の管理サーバとなる NDB Server のセットアップについて概要を説明します。

## NDB Server のセットアップの流れ

NDB Server は、仮想アプライアンスとして提供されており、次のような流れでセットアップします。AHV と ESXi とで若干の違いがあります。

AHV 上でのセットアップ

1. ``QCOW2 ディスク イメージをイメージ サービスに登録する``
2. 仮想マシンの作成``（vDisk はイメージ サービスに登録したディスク イメージから作成。ネットワーク設定は cloud-init を利用）``
3. 仮想マシンの起動
4. Web ブラウザからアクセスして admin パスワード設定と EULA への同意
5. 「NDB へようこそ」ウィザードでのセットアップ

ESXi 上でのセットアップ

1. ``OVA ファイルのデプロイ``
2. 仮想マシンの起動
3. ``ゲスト OS でのネットワーク設定（era-server CLI を利用）``
4. Web ブラウザからアクセスして admin パスワード設定と EULA への同意
5. 「NDB へようこそ」ウィザードでのセットアップ

## 「NDB へようこそ」ウィザード

NDB Server では、Web UI への初回ログイン時に「NDB へようこそ」というウィザードで基本的なセットアップを実施します。

1. NDB クラスタ

    Nutanix クラスタを、NDB Server に登録します。
    * このとき、Nutanix クラスタの VIP アドレスを指定します。ちなみに、FQDN だと入力拒否されます。
    * 登録する Nutanix クラスタは、NDB Server 自身が稼働しているクラスタである必要があります。

2. ネットワーク セグメンテーション

    NDB Server が通信するネットワーク（VLAN）を選択します。Prism Element との管理通信の選択は必須で、それ以外はオプションで分離可能です。
    * Prism Element との管理通信
    * Prism iSCSI データサービス ※オプション
    * NDB サーバからの DB サーバへの通信 ※オプション

3. サービス

    次のサービス設定をします。
    * DNS サーバ
    * NTP サーバ
    * タイムゾーン
    * SMTP サーバ

4. ストレージ コンテナ

    DB と DB サーバのプロビジョニングで使用するストレージ コンテナを指定します。

5. ネットワーク プロファイル

    NDB でプロビジョニングする DB と DB サーバを接続するネットワークを指定する「ネットワーク プロファイル」を作成します。これは、あとからでも作成可能です。
